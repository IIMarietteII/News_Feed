<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>[ì—ì´ì•¤ì´ ê¸€ë¡œë²Œ ë¯¸ë””ì–´] ì—…ê³„ ë™í–¥</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', 'Malgun Gothic', sans-serif;
      background-color: #f4f4f4;
      color: #333;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background-color: #fff;
      padding: 20px;
    }
    .header {
      text-align: center;
      padding-bottom: 10px;
      border-bottom: 3px solid #2c64b4;
    }
    .header h1 {
      margin: 0;
      font-size: 24px;
      color: #2c64b4;
    }
    .date {
      font-size: 14px;
      color: #666;
      margin-top: 5px;
    }
    .section {
      margin-top: 30px;
    }
    .section-title {
      font-size: 18px;
      color: #2c64b4;
      border-bottom: 1px solid #ccc;
      padding-bottom: 5px;
    }
    .article {
      margin-bottom: 20px;
    }
    .article-title {
      font-weight: bold;
      font-size: 16px;
      margin: 0;
    }
    .article-summary {
      font-size: 14px;
      color: #555;
    }
    .article-link {
      font-size: 13px;
      color: #2c64b4;
      text-decoration: none;
    }
    .footer {
      font-size: 12px;
      text-align: center;
      margin-top: 30px;
      color: #999;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>[ì—ì´ì•¤ì´ ê¸€ë¡œë²Œ ë¯¸ë””ì–´] ì—…ê³„ ë™í–¥</h1>
      <div class="date" id="page-date"></div>
    </div>
    <div id="app"></div>
    <div class="footer">
      <p>ë” ìì„¸í•œ ì •ë³´ê°€ í•„ìš”í•˜ì‹œê±°ë‚˜ íŠ¹ì • ì£¼ì œì— ëŒ€í•œ ì‹¬ì¸µ ë¶„ì„ì„ ì›í•˜ì‹œë©´ í™ë³´íŒ€(yura.choi@aegm.com)ìœ¼ë¡œ ì—°ë½ì£¼ì„¸ìš”.</p>
      <p>Â© 2025 [ì—ì´ì•¤ì´ ê¸€ë¡œë²Œ ë¯¸ë””ì–´ ì½”ë¦¬ì•„]. All rights reserved.</p>
    </div>
  </div>
  <script>
    const kstFormatter = new Intl.DateTimeFormat("ko-KR", {
      timeZone: "Asia/Seoul",
      year: "numeric",
      month: "numeric",
      day: "numeric",
      weekday: "short",
    });
    const parts = kstFormatter.formatToParts(new Date());
    const formatted = `${parts.find(p => p.type === "year").value}ë…„ ${parts.find(p => p.type === "month").value}ì›” ${parts.find(p => p.type === "day").value}ì¼ (${parts.find(p => p.type === "weekday").value})`;
    document.getElementById("page-date").innerText = formatted;

    const params = new URLSearchParams(location.search);
    const ids = (params.get('ids') || '').split(',').map(decodeURIComponent);

    fetch('data/articles.json')
      .then(res => res.json())
      .then(data => {
        const filtered = data.filter(article => ids.includes(article.link));

        const grouped = {
          "K_Entertainment": [],
          "K_OTT": [],
          "AI": [],
          "News": []
        };

        filtered.forEach(article => {
          const source = article.source?.trim();
          if (grouped[source]) {
            grouped[source].push(article);
          }
        });

        const app = document.getElementById("app");

        Object.entries(grouped).forEach(([source, articles]) => {
          if (articles.length === 0) return;

          console.log(`ğŸ—‚ï¸ [${source}] ì •ë ¬ ì „`);
          articles.forEach(a => console.log(a.published, a.title));

          // âœ… ë‚ ì§œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
          articles.sort((a, b) =>
            new Date((a.published || "").trim()) - new Date((b.published || "").trim())
          );

          console.log(`âœ… [${source}] ì •ë ¬ í›„`);
          articles.forEach(a => console.log(a.published, a.title));

          const section = document.createElement("div");
          section.className = "section";
          section.innerHTML = `<h2 class="section-title">${source}</h2>`;

          articles.forEach(article => {
            section.innerHTML += `
              <div class="article">
                <h3 class="article-title">${article.title}</h3>
                <p class="article-summary">${article.summary}</p>
                <a class="article-link" href="${article.link}" target="_blank">ì›ë¬¸ ë§í¬ â†’</a>
              </div>
            `;
          });

          app.appendChild(section);
        });
      })
      .catch(err => {
        console.error("ë‰´ìŠ¤ ë¡œë”© ì˜¤ë¥˜:", err);
        document.getElementById("app").innerHTML = "<p>ë‰´ìŠ¤ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>";
      });
  </script>
</body>
</html>
